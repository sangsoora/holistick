<div class="container practitioner-page">
  <div class="practitioner-summary">
    <div class="practitioner-img">
      <% if @practitioner.photo.attached? %>
        <%= cl_image_tag @practitioner.photo.key, class: 'avatar-full' %>
      <% else %>
        <img src='https://kitt.lewagon.com/placeholder/users/random' class='avatar-full' />
      <% end %>
    </div>
    <div class="practitioner-body">
      <div class="practitioner-name">
        <button class="verified">Verified</button>
        <h3><%= @practitioner.user.full_name %></h3>
        <p class="practitioner-rating">
          <% if @practitioner.reviews.count > 0 %>
            <i class="fas fa-star mr-2 pink-icon"></i><%= @practitioner.rating_avg %> (<%= @practitioner.reviews.count %>)
          <% else %>
            No reviews!
          <% end %>
        </p>
      </div>
      <div class="practitioner-detail">
        <p>Specailty:
          <%= @practitioner.specialties.pluck(:name).join(', ') %>
        </p>
        <p>Languages:
          <%= @practitioner.languages.pluck(:name).join(', ') %>
        </p>
        <div>
          <p>Working hours (in your current time zone: <span id='time-zone'></span>)</p>
          <table class='working-hours col-8'>
            <tr>
              <th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th><th></th>
            </tr>
            <% if user_signed_in? %>
              <tr>
                <% (0..6).to_a.each do |num| %>
                  <% if @converted_working_hours[num] != [] %>
                    <% if @converted_working_hours[num].first[:starts] < '04:00' %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].first[:starts] %> ~ <%= @converted_working_hours[num].first[:ends] %></p></div></div></td>
                    <% else %>
                      <td></td>
                    <% end %>
                  <% else %>
                    <td></td>
                  <% end %>
                <% end %>
                <td class='time'>00 ~ 04</td>
              </tr>
              <tr>
                <% (0..6).to_a.each do |num| %>
                  <% if @converted_working_hours[num] != [] %>
                    <% if (@converted_working_hours[num].first[:starts] < '04:00' && @converted_working_hours[num].first[:ends] > '08:00') || (@converted_working_hours[num].first[:starts] >= '04:00' && @converted_working_hours[num].first[:starts] < '08:00') || (@converted_working_hours[num].first[:ends] > '04:00' && @converted_working_hours[num].first[:ends] <= '08:00') %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].first[:starts] %> ~ <%= @converted_working_hours[num].first[:ends] %></p></div></div></td>
                    <% elsif (@converted_working_hours[num].last[:starts] < '04:00' && @converted_working_hours[num].last[:ends] > '08:00') || (@converted_working_hours[num].last[:starts] >= '04:00' && @converted_working_hours[num].last[:starts] < '08:00') || (@converted_working_hours[num].last[:ends] > '04:00' && @converted_working_hours[num].last[:ends] <= '08:00') %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].last[:starts] %> ~ <%= @converted_working_hours[num].last[:ends] %></p></div></div></td>
                    <% else %>
                      <td></td>
                    <% end %>
                  <% else %>
                    <td></td>
                  <% end %>
                <% end %>
                <td class='time'>04 ~ 08</td>
              </tr>
              <tr>
                <% (0..6).to_a.each do |num| %>
                  <% if @converted_working_hours[num] != [] %>
                    <% if (@converted_working_hours[num].first[:starts] < '08:00' && @converted_working_hours[num].first[:ends] > '12:00') || (@converted_working_hours[num].first[:starts] >= '08:00' && @converted_working_hours[num].first[:starts] < '12:00') || (@converted_working_hours[num].first[:ends] > '08:00' && @converted_working_hours[num].first[:ends] <= '12:00') %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].first[:starts] %> ~ <%= @converted_working_hours[num].first[:ends] %></p></div></div></td>
                    <% elsif (@converted_working_hours[num].last[:starts] < '08:00' && @converted_working_hours[num].last[:ends] > '12:00') || (@converted_working_hours[num].last[:starts] >= '08:00' && @converted_working_hours[num].last[:starts] < '12:00') || (@converted_working_hours[num].last[:ends] > '08:00' && @converted_working_hours[num].last[:ends] <= '12:00') %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].last[:starts] %> ~ <%= @converted_working_hours[num].last[:ends] %></p></div></div></td>
                    <% else %>
                      <td></td>
                    <% end %>
                  <% else %>
                    <td></td>
                  <% end %>
                <% end %>
                <td class='time'>08 ~ 12</td>
              </tr>
              <tr>
                <% (0..6).to_a.each do |num| %>
                  <% if @converted_working_hours[num] != [] %>
                    <% if (@converted_working_hours[num].first[:starts] < '12:00' && @converted_working_hours[num].first[:ends] > '16:00') || (@converted_working_hours[num].first[:starts] >= '12:00' && @converted_working_hours[num].first[:starts] < '16:00') || (@converted_working_hours[num].first[:ends] > '12:00' && @converted_working_hours[num].first[:ends] <= '16:00') %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].first[:starts] %> ~ <%= @converted_working_hours[num].first[:ends] %></p></div></div></td>
                    <% elsif (@converted_working_hours[num].last[:starts] < '12:00' && @converted_working_hours[num].last[:ends] > '16:00') || (@converted_working_hours[num].last[:starts] >= '12:00' && @converted_working_hours[num].last[:starts] < '16:00') || (@converted_working_hours[num].last[:ends] > '12:00' && @converted_working_hours[num].last[:ends] <= '16:00') %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].last[:starts] %> ~ <%= @converted_working_hours[num].last[:ends] %></p></div></div></td>
                    <% else %>
                      <td></td>
                    <% end %>
                  <% else %>
                    <td></td>
                  <% end %>
                <% end %>
                <td class='time'>12 ~ 16</td>
              </tr>
              <tr>
                <% (0..6).to_a.each do |num| %>
                  <% if @converted_working_hours[num] != [] %>
                    <% if (@converted_working_hours[num].first[:starts] < '16:00' && @converted_working_hours[num].first[:ends] > '20:00') || (@converted_working_hours[num].first[:starts] >= '16:00' && @converted_working_hours[num].first[:starts] < '20:00') || (@converted_working_hours[num].first[:ends] > '16:00' && @converted_working_hours[num].first[:ends] <= '20:00') %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].first[:starts] %> ~ <%= @converted_working_hours[num].first[:ends] %></p></div></div></td>
                    <% elsif (@converted_working_hours[num].last[:starts] < '16:00' && @converted_working_hours[num].last[:ends] > '20:00') || (@converted_working_hours[num].last[:starts] >= '16:00' && @converted_working_hours[num].last[:starts] < '20:00') || (@converted_working_hours[num].last[:ends] > '16:00' && @converted_working_hours[num].last[:ends] <= '20:00') %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].last[:starts] %> ~ <%= @converted_working_hours[num].last[:ends] %></p></div></div></td>
                    <% else %>
                      <td></td>
                    <% end %>
                  <% else %>
                    <td></td>
                  <% end %>
                <% end %>
                <td class='time'>16 ~ 20</td>
              </tr>
              <tr>
                <% (0..6).to_a.each do |num| %>
                  <% if @converted_working_hours[num] != [] %>
                    <% if @converted_working_hours[num].last[:ends] > '20:00' %>
                      <td><div class="available-cell"><div class="available-hours"><p><%= @converted_working_hours[num].last[:starts] %> ~ <%= @converted_working_hours[num].last[:ends] %></p></div></div></td>
                    <% else %>
                      <td></td>
                    <% end %>
                  <% else %>
                    <td></td>
                  <% end %>
                <% end %>
                <td class='time'>20 ~ 24</td>
              </tr>
            <% end %>
          </table>
        </div>
      </div>
    </div>
    <div class="practitioner-btn" id="practitioner-btn">
      <%= render 'favorite_practitioners/practitioner_btn', practitioner: @practitioner %>
    </div>
  </div>
  <div class="practitioner-description">
    <div class="practitioner-description-left">
      <div class="practitioner-bio">
        <h3>Bio</h3>
        <p><%= @practitioner.bio %></p>
      </div>
      <div class="practitioner-services">
        <h3>Services</h3>
        <% @practitioner.services.each do |service| %>
          <div class="practitioner-service">
            <div class="practitioner-service-info">
              <div class="d-flex justify-content-between align-items-center">
                <h4><%= service.name %></h4>
                <% if current_user != @practitioner.user %>
                  <%= link_to 'Book now', service_path(service), class: 'btn btn-flat' %>
                <% end %>
              </div>
              <% if service.reviews.count > 0 %>
                <p><i class="fas fa-star mr-2 pink-icon"></i><%= service.rating_avg %> (<%= service.reviews.count %>)</p>
              <% else %>
                <p>No reviews!</p>
              <% end %>
              <p>Service Type: <%= service.service_type.capitalize %></p>
              <p>Duration: <%= service.duration %>m</p>
              <p>Service Price: CA<%= humanized_money_with_symbol(service.price) %></p>
              <div class="practitioner-service-description">
                <p><%= service.description %></p>
                <!-- <button>+ show more</button> -->
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <div class="practitioner-description-right">
      <div class="practitioner-video">
        <div class="embed-responsive embed-responsive-16by9">
          <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/<%= @practitioner.video %>?autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
      </div>
      <div class="practitioner-review mt-5">
        <% @practitioner.reviews.each do |review| %>
          <p><% review.rating.times { %> <i class="fas fa-star pink-icon"></i> <% } %> - <%= review.comment %> <small><i>by <%= review.session.user.full_name %></i></small></p>
        <% end %>
      </div>
    </div>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('time-zone').innerHTML = moment.tz.guess();
    <% unless user_signed_in? %>
      const user_time_offset = moment.tz.zone(moment.tz.guess()).utcOffset(Date.now());
      const practitioner_time_offset = moment.tz.zone('<%= @practitioner.timezone %>').utcOffset(Date.now());
      const time_diff = user_time_offset - practitioner_time_offset;
      let converted_working_hours = {};
      <% (0..6).to_a.each do |num| %> converted_working_hours[<%= num %>] = []; <% end %>
      <% @practitioner.working_hours.each do |workingday| %>
        let converted_open_hour_<%= workingday.day %> = '';
        <% unless workingday.opens == nil %>
          converted_open_hour_<%= workingday.day %> = moment('<%= workingday.opens %>').subtract(time_diff, 'm').toISOString();
        <% end %>
        let converted_close_hour_<%= workingday.day %> = '';
        <% unless workingday.closes == nil %>
          if ((('0'+new Date(<%= workingday.closes %>).getHours()).substr(-2) + ':' + ('0'+new Date(<%= workingday.closes %>).getMinutes()).substr(-2)) == '00:00') {
            converted_close_hour_<%= workingday.day %> = moment('<%= workingday.closes %>').add(1, 'days').subtract(time_diff, 'm').toISOString();
          }
          converted_close_hour_<%= workingday.day %> = moment('<%= workingday.closes %>').subtract(time_diff, 'm').toISOString();
        <% end %>
        if ((converted_open_hour_<%= workingday.day %> != '' ) && (converted_close_hour_<%= workingday.day %> != '')) {
          if ((<%= workingday.day %> == 1) || (<%= workingday.day %> == 2) || (<%= workingday.day %> == 3) || (<%= workingday.day %> == 4) || (<%= workingday.day %> == 5)) {
            if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '31') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '31')) {
              converted_working_hours[<%= workingday.day %> - 1].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2)).substr(-2), 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '31') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '01')) {
              converted_working_hours[<%= workingday.day %> - 1].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': '24:00' });
              if ((('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2)) != '00:00') {
                converted_working_hours[<%= workingday.day %>].push({ 'starts': '00:00', 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2)).substr(-2) });
              }
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '1') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '01')) {
              converted_working_hours[<%= workingday.day %>].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '1') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '02')) {
              converted_working_hours[<%= workingday.day %>].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': '24:00' });
              converted_working_hours[<%= workingday.day %> + 1].push({ 'starts': '00:00', 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '2') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '02')) {
              converted_working_hours[<%= workingday.day %> + 1].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            }
          } else if (<%= workingday.day %> == 0) {
            if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '31') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '31')) {
              converted_working_hours[6].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '31') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '01')) {
              converted_working_hours[6].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': '24:00' });
              converted_working_hours[<%= workingday.day %>].push({ 'starts': '00:00', 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            }
            else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '1') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '01')) {
              converted_working_hours[<%= workingday.day %>].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '1') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '02')) {
              converted_working_hours[<%= workingday.day %>].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': '24:00' });
              converted_working_hours[<%= workingday.day %> + 1].push({ 'starts': '00:00', 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '2') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '02')) {
              converted_working_hours[<%= workingday.day %> + 1].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            }
          } else if (<%= workingday.day %> == 6) {
            if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '31') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '31')) {
              converted_working_hours[<%= workingday.day %> - 1].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '31') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '01')) {
              converted_working_hours[<%= workingday.day %> - 1].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': '24:00' });
              converted_working_hours[<%= workingday.day %>].push({ 'starts': '00:00', 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '1') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '01')) {
              converted_working_hours[<%= workingday.day %>].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '1') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '02')) {
              converted_working_hours[<%= workingday.day %>].push({ 'starts': ('0'+('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2)).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': '24:00' });
              converted_working_hours[0].push({ 'starts': "00:00", 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            } else if ((new Date(converted_open_hour_<%= workingday.day %>).getDate() == '2') && (new Date(converted_close_hour_<%= workingday.day %>).getDate() == '02')) {
              converted_working_hours[0].push({ 'starts': ('0'+new Date(converted_open_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_open_hour_<%= workingday.day %>).getMinutes()).substr(-2), 'ends': ('0'+new Date(converted_close_hour_<%= workingday.day %>).getHours()).substr(-2) + ':' + ('0'+new Date(converted_close_hour_<%= workingday.day %>).getMinutes()).substr(-2) });
            }
          }
        }
      <% end %>
      console.log(converted_working_hours);
      const table = document.getElementsByTagName('table')[0];
      let html = '';
      html += `<tr>`;
      for (var i = 0; i < 7; i++) {
        if (converted_working_hours[i].length > 0) {
          if (converted_working_hours[i][0]['starts'] < '04:00') {
            html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][0]['starts'] +` ~ `+ converted_working_hours[i][0]['ends'] +`</p></div></div></td>`;
          } else {
            html += `<td></td>`;
          }
        } else {
          html += `<td></td>`;
        }
      }
      html += `<td class='time'>00 ~ 04</td>
               </tr>`;
      html += `<tr>`;
      for (var i = 0; i < 7; i++) {
        if (converted_working_hours[i].length == 1) {
          if (((converted_working_hours[i][0]['starts'] < '04:00') && (converted_working_hours[i][0]['ends'] > '08:00')) || ((converted_working_hours[i][0]['starts'] >= '04:00') && (converted_working_hours[i][0]['starts'] < '08:00')) || ((converted_working_hours[i][0]['ends'] > '04:00') && (converted_working_hours[i][0]['ends'] <= '08:00'))) {
            html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][0]['starts'] +` ~ `+ converted_working_hours[i][0]['ends'] +`</p></div></div></td>`;
          } else if (converted_working_hours[i].length == 2) {
            if (((converted_working_hours[i][1]['starts'] < '04:00') && (converted_working_hours[i][1]['ends']> '08:00')) || ((converted_working_hours[i][1]['starts'] >= '04:00') && (converted_working_hours[i][1]['starts'] < '08:00')) || ((converted_working_hours[i][1]['ends'] > '04:00') && (converted_working_hours[i][1]['ends'] <= '08:00'))) {
              html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][1]['starts'] +` ~ `+ converted_working_hours[i][1]['ends'] +`</p></div></div></td>`;
            }
          } else {
            html += `<td></td>`;
          }
        } else {
          html += `<td></td>`;
        }
      }
      html += `<td class='time'>04 ~ 08</td>
               </tr>`;
      html += `<tr>`;
      for (var i = 0; i < 7; i++) {
        if (converted_working_hours[i].length == 1) {
          if (((converted_working_hours[i][0]['starts'] < '08:00') && (converted_working_hours[i][0]['ends'] > '12:00')) || ((converted_working_hours[i][0]['starts'] >= '08:00') && (converted_working_hours[i][0]['starts'] < '12:00')) || ((converted_working_hours[i][0]['ends'] > '08:00') && (converted_working_hours[i][0]['ends'] <= '12:00'))) {
            html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][0]['starts'] +` ~ `+ converted_working_hours[i][0]['ends'] +`</p></div></div></td>`;
          } else if (converted_working_hours[i].length == 2) {
            if (((converted_working_hours[i][1]['starts'] < '08:00') && (converted_working_hours[i][1]['ends']> '12:00')) || ((converted_working_hours[i][1]['starts'] >= '08:00') && (converted_working_hours[i][1]['starts'] < '12:00')) || ((converted_working_hours[i][1]['ends'] > '08:00') && (converted_working_hours[i][1]['ends'] <= '12:00'))) {
              html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][1]['starts'] +` ~ `+ converted_working_hours[i][1]['ends'] +`</p></div></div></td>`;
            }
          } else {
            html += `<td></td>`;
          }
        } else {
          html += `<td></td>`;
        }
      }
      html += `<td class='time'>08 ~ 12</td>
               </tr>`;
      html += `<tr>`;
      for (var i = 0; i < 7; i++) {
        if (converted_working_hours[i].length == 1) {
          if (((converted_working_hours[i][0]['starts'] < '12:00') && (converted_working_hours[i][0]['ends'] > '16:00')) || ((converted_working_hours[i][0]['starts'] >= '12:00') && (converted_working_hours[i][0]['starts'] < '16:00')) || ((converted_working_hours[i][0]['ends'] > '12:00') && (converted_working_hours[i][0]['ends'] <= '16:00'))) {
            html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][0]['starts'] +` ~ `+ converted_working_hours[i][0]['ends'] +`</p></div></div></td>`;
          } else if (converted_working_hours[i].length == 2) {
            if (((converted_working_hours[i][1]['starts'] < '12:00') && (converted_working_hours[i][1]['ends']> '16:00')) || ((converted_working_hours[i][1]['starts'] >= '12:00') && (converted_working_hours[i][1]['starts'] < '16:00')) || ((converted_working_hours[i][1]['ends'] > '12:00') && (converted_working_hours[i][1]['ends'] <= '16:00'))) {
              html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][1]['starts'] +` ~ `+ converted_working_hours[i][1]['ends'] +`</p></div></div></td>`;
            }
          } else {
            html += `<td></td>`;
          }
        } else {
          html += `<td></td>`;
        }
      }
      html += `<td class='time'>12 ~ 16</td>
               </tr>`;
      html += `<tr>`;
      for (var i = 0; i < 7; i++) {
        if (converted_working_hours[i].length == 1) {
          if (((converted_working_hours[i][0]['starts'] < '16:00') && (converted_working_hours[i][0]['ends'] > '20:00')) || ((converted_working_hours[i][0]['starts'] >= '16:00') && (converted_working_hours[i][0]['starts'] < '20:00')) || ((converted_working_hours[i][0]['ends'] > '16:00') && (converted_working_hours[i][0]['ends'] <= '20:00'))) {
            html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][0]['starts'] +` ~ `+ converted_working_hours[i][0]['ends'] +`</p></div></div></td>`;
          } else if (converted_working_hours[i].length == 2) {
            if (((converted_working_hours[i][1]['starts'] < '16:00') && (converted_working_hours[i][1]['ends']> '20:00')) || ((converted_working_hours[i][1]['starts'] >= '16:00') && (converted_working_hours[i][1]['starts'] < '20:00')) || ((converted_working_hours[i][1]['ends'] > '16:00') && (converted_working_hours[i][1]['ends'] <= '20:00'))) {
              html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][1]['starts'] +` ~ `+ converted_working_hours[i][1]['ends'] +`</p></div></div></td>`;
            }
          } else {
            html += `<td></td>`;
          }
        } else {
          html += `<td></td>`;
        }
      }
      html += `<td class='time'>16 ~ 20</td>
               </tr>`;
      html += `<tr>`;
      for (var i = 0; i < 7; i++) {
        if (converted_working_hours[i].length > 0) {
          if (converted_working_hours[i][converted_working_hours[i].length-1]['ends'] > '20:00') {
            html += `<td><div class="available-cell"><div class="available-hours"><p>`+ converted_working_hours[i][converted_working_hours[i].length-1]['starts'] +` ~ `+ converted_working_hours[i][converted_working_hours[i].length-1]['ends'] +`</p></div></div></td>`;
          } else {
            html += `<td></td>`;
          }
        } else {
          html += `<td></td>`;
        }
      }
      html += `<td class='time'>20 ~ 24</td>
               </tr>`;
      table.insertAdjacentHTML('beforeend', html);
    <% end %>
  });
</script>
